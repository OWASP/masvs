# 移动应用安全验证标准

MASVS 可用于建立移动应用程序安全性的可信程度。制定需求时考虑到了以下目的：

- 可用于度量标准 - 提供一个安全标准，让开发人员和应用程序拥有者比较现有的移动应用程序;
- 可用作指导 - 在移动应用开发和测试的每个阶段提供指导;
- 可在采购过程中使用 - 为移动应用安全性验证提供基线。

## 移动应用安全模型 (Mobile AppSec Model)

`MASVS`定义了两个安全验证级别（MASVS-L1 和 MASVS-L2），以及一组逆向工程弹性要求（MASVS-R）。 MASVS-L1 包含所有移动应用程序都建议使用的通用安全要求，而 MASVS-L2 应该应用于处理高度敏感数据的应用程序。如果设计目标是防止客户端威胁，则可以应用 MASVS-R覆 盖其他保护性控制。

满足 MASVS-L1 中的要求将获得一个遵循安全最佳实践的安全应用程序，并且，不会遭受常见漏洞的困扰。 MASVS-L2 添加了其他深度防御控件（如SSL固定），从而使应用程序可以抵抗更复杂的攻击 - 假设移动操作系统的安全控件完好无损，并且最终用户不被视为潜在的威胁。满足MASVS-R中全部或部分软件保护要求，有助于阻止特定客户端威胁，包括用户恶意终端和/或移动操作系统被破坏。

**I：尽管我们建议每个移动应用程序中实施 `MASVS-L1` 管制，但是否实施安全治理最终应是基于风险的决策，该决策应与企业所有者沟通。**

**II：请注意，`MASVS-R` 中列出的软件保护管制以及<OWASP移动安全性测试指南>中所述的软件保护管制最终是可以被忽略的，绝不能用作安全管控的替代品。相反，它在为应用程序添加额外的，针对于威胁的保护控制，以满足MASVS-l1或MASVS- l2中的MASVS要求。**

![验证级别](images/masvs-levels-new.jpg)

### 文档结构

MASVS的第一部分包含对安全模型和可用验证级别的描述，然后是有关如何在实践中使用该标准的建议。而在第二部分中，列出了详细的安全要求以及对对应的验证级别。根据技术目标/范围，将需求分为8类（V1至V8）。在整个MASVS和MSTG中使用以下术语：

-*要求类别:* MASVS-Vx，例如 MASVS-V2: 数据存储和隐私
-*要求:* MASVS-Vx.y，例如 MASVS-V2.2: "没有敏感数据写入应用程序日志"
  
### 验证级别 - 细节

#### MASVS-L1：标准安全性

实现`MASVS-L1`的移动应用程序,遵循移动应用程序安全性最佳实际。它满足了基础要求，包括代码质量，敏感数据处理，以及与移动环境交互方面。必须有一个测试流程来验证安全管控。此级别适用于所有移动应用程序。

#### MASVS-L2：深度防御

`MASVS-L2`引入了超出标准要求的高级安全管控。为了实现`MASVS-L2`，必须实现威胁模型，且安全必须是应用程序的架构和设计的内部组件。基于威胁模型，应该选择正确的`MASVS-L2`管控并成功地实现它们。这个级别适用于处理高度敏感数据的应用程序，比如移动银行应用程序。

#### MASVS-R：抵抗逆向工程和篡改的能力

该应用程序具有最先进的安全性，还可以抵御明确定义的特定客户端攻击，例如篡改，修改或反向工程以提取敏感代码或数据。这样的应用程序要么利用硬件安全功能，要么利用足够强大且可验证的软件保护技术。 MASVS-R适用于处理高度敏感数据的应用程序，并且可以用作保护知识产权或防篡改应用程序的一种方式。

### 使用推荐

可以根据事先的风险评估和所需的总体安全级别，针对`MASVS L1`或`L2`验证应用程序。 L1适用于所有移动应用程序，而L2通常建议用于处理更敏感数据和/或功能的应用程序。 MASVS-R（或其一部分）可用于验证针对特定威胁的弹性，例如重新包装或提取敏感数据，以及适当的安全验证。

总之，可以使用以下验证类型：

- MASVS-L1
- MASVS-L1 + R
- MASVS-L2
- MASVS-L2 + R


不同的组合反映了不同级别的安全性和弹性。 目的是要安全具有灵活性：例如，出于可用性的原因，移动游戏可能不愿意添加`MASVS-L2`安全控制（例如 双因素身份验证），但是在防止篡改方面存在强烈的业务需求。
<div style="page-break-after: always;">
</div>

#### 选择哪种验证类型

实现`MASVS L2`的需求增加了安全性，同时增加了开发成本，并有可能恶化最终用户体验(传统的权衡)。一般来说，只要从风险与成本的角度来看(比如，当你想使用L2时，若机密性或完整性的妥协所造成的潜在损失高于额外的安全控制所招致的成本，就应该使用它.) 总的来说，在应用MASVS之前，风险评估应该是第一步。

##### 举例

###### MASVS-L1

- 所有移动应用。 MASVS-L1列出了可以遵循的最佳安全实践，对开发成本和用户体验产生了合理的影响。将MASVS-L1中的要求应用于任何不符合较高级别的应用。

###### MASVS-L2

- 保健行业：存储个人身份信息的移动应用程序，这些信息可用于身份盗窃，欺诈性付款或各种欺诈方案。对于美国医疗保健部门，合规性考虑因素包括《健康保险可移植性和责任法案》（HIPAA）隐私权，安全性，违约通知规则和患者安全规则。

- 金融行业：可以访问高度敏感的信息（例如信用卡号，个人信息）或允许用户转移资金的应用。这些应用程序需要其他安全控制措施，以防止欺诈。金融应用需要确保遵守支付卡行业数据安全标准（PCI DSS），《格莱姆·里奇·布利利法案》和《萨班斯-奥克斯利法案》（SOX）。

###### MASVS L1 + R

- 以知识产权（IP）保护为业务目标的移动应用程序。 MASVS-R中列出的弹性控制，可用于增加获取原始源代码和阻止篡改/破解所需的难度。

- 游戏产业：竞争激烈的在线游戏等对防止游戏和作弊至关重要的游戏。作弊是在线游戏中的一个重要问题，因为大量作弊会导致不满的玩家群体，并最终导致游戏失败。 MASVS-R提供基本的防篡改控件，以帮助增加作弊者的工作量。

###### MASVS L2 + R

- 金融业：允许用户转移资金的在线银行应用程序，其中代码注入和在受损设备上的检测等技术会带来风险。在这种情况下，可以使用MASVS-R的控件来阻止篡改，从而提高恶意软件作者的横竿。

- 所有移动应用，根据设计需要将敏感数据存储在移动设备上，同时必须支持各种设备和操作系统版本的移动应用程序。在这种情况下，弹性控制可用作深度防御措施，以增加攻击者在提取敏感数据的工作量。

- 带有内部购买能力的应用最好使用服务器端和`MASVS-L2`管控来保护付费内容。然而，在某些情况下，不可能使用服务器端保护。在这些情况下，应另外使用`MASVS-R`管控，以增加逆向和/或篡改的难度。