# V2：数据存储和隐私要求

## 管控目标

保护敏感数据（例如用户凭据和私人信息）是移动安全的重点。首先，假设不正确地使用IPC等操作系统机制，敏感数据可能会意外暴露给同一设备上运行的其他应用程序。数据也可能会意外泄漏到云存储，备份或键盘缓存中。此外，与其他类型的设备相比，移动设备可能更容易丢失或被盗，因此，获得物理访问权的对手更有可能出现这种情况。在这种情况下，可以实施其他保护措施以使检索敏感数据更加困难。

请注意，由于MASVS以应用程序为中心，因此它不涵盖设备级策略，例如MDM解决方案实施的策略。我们鼓励在企业环境中使用此类策略，以进一步增强数据安全性。

### 敏感数据的定义

MASVS上下文中的敏感数据与用户凭据以及在特定上下文中被认为敏感的任何其他数据有关，例如：

- 可以被滥用为身份盗用的个人身份信息（PII）：社会保险号，信用卡号，银行帐号，健康信息；
- 高度敏感的数据，如果受到损害，将导致声誉受损和/或财务损失：合同信息，保密协议涵盖的信息，管理信息；
- 必须受法律保护或出于合规原因而必须保护的任何数据。

<div style="page-break-after: always;" >
</div>

## 安全验证要求

遵循简单的规则可以避免绝大多数数据泄露问题。本章中列出的大多数控制对于所有验证级别都是必需的。

| # | MSTG-ID |描述 | L1 | L2 |
| --- | --- | --- | --- | --- |
| **2.1** | MSTG‑STORAGE‑1 |需要使用系统凭据存储设施来存储敏感数据，如PII、用户凭据或加密密钥。 | ✓| ✓|
| **2.2** | MSTG‑STORAGE‑2 |不应将敏感数据存储在app容器或系统凭据存储设施之外。 | ✓| ✓|
| **2.3** | MSTG‑STORAGE‑3 |没有敏感数据写入应用程序日志。 | ✓| ✓|
| **2.4** | MSTG‑STORAGE‑4 |除非敏感数据是体系结构的必要部分，否则不会与第三方共享。 | ✓| ✓|
| **2.5** | MSTG‑STORAGE‑5 |在处理敏感数据的文本输入上，键盘缓存被禁用。 | ✓| ✓|
| **2.6** | MSTG‑STORAGE‑6 |不会通过IPC机制公开敏感数据。 | ✓| ✓|
| **2.7** | MSTG‑STORAGE‑7 |用户界面不会暴露任何敏感数据，例如密码或密码。 | ✓| ✓|
| **2.8** | MSTG‑STORAGE‑8 |移动操作系统生成的备份中不包含敏感数据。 | | ✓|
| **2.9** | MSTG‑STORAGE‑9 |当移至后台时，该应用程序将从视图中删除敏感数据。 | | ✓|
| **2.10** | MSTG‑STORAGE‑10 |该应用程序在内存中保存敏感数据的时间不会超过必要时间，并且使用后会明确清除内存。 | | ✓|
| **2.11** | MSTG‑STORAGE‑11 |该应用会强制执行最低设备访问安全性政策，例如要求用户设置设备密码。 | | ✓|
| **2.12** | MSTG‑STORAGE‑12 |该应用程序可向用户介绍所处理的个人身份信息的类型，以及用户在使用该应用程序时应遵循的最佳安全性最佳做法。 | | ✓|
| **2.13** | MSTG‑STORAGE‑13 |不应将任何敏感数据本地存储在移动设备上。相反，应在需要时从远程端点检索数据，并将其仅保存在内存中。 | | ✓|
| **2.14** | MSTG‑STORAGE‑14 |如果仍然需要在本地存储敏感数据，则应该使用来自需要身份验证的硬件支持存储的密钥对其进行加密。 | | ✓|
| **2.15** | MSTG‑STORAGE‑15 |应用程序的本地存储在过多的失败身份验证尝试之后应该被清除。 | | ✓|

## 参考文献

OWASP移动安全测试指南提供了验证本节中列出的要求的详细说明。

- Android：测试数据存储 - <https://github.com/OWASP/owasp-mstg/blob/master/Document/0x05d-Testing-Data-Storage.md>
- iOS：测试数据存储 - <https://github.com/OWASP/owasp-mstg/blob/master/Document/0x06d-Testing-Data-Storage.md>

有关更多信息，另请参见:

- OWASP 移动安全前 10: M2 (不安全数据存储) - <https://www.owasp.org/index.php/Mobile_Top_10_2016-M2-Insecure_Data_Storage>
- CWE 922 (敏感信息的不安全存储) - <https://cwe.mitre.org/data/definitions/922.html>
