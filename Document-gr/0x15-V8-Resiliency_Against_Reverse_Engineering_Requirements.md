# V8: Απαιτήσεις Ανθεκτικότητας

## Στόχος Ελέγχου

Αυτή η ενότητα καλύπτει μέτρα άμυνας σε βάθος (defense-in-depth) που προτείνονται για εφαρμογές που επεξεργάζονται ή παρέχουν πρόσβαση σε ευαίσθητα δεδομένα ή λειτουργίες. Η έλλειψη κάποιου από αυτά τα στοιχεία ελέγχου δεν προκαλεί ευπάθεια. Αντίθετα, προορίζονται να αυξήσουν την ανθεκτικότητα της εφαρμογής έναντι τoυ reverse engineering και συγκεκριμένων επιθέσεων από την πλευρά του client.

Οι έλεγχοι σε αυτήν την ενότητα θα πρέπει να εφαρμοστούν όπως πρέπει, η αξιολόγηση των κινδύνων που προκαλείται από μη εξουσιοδοτημένη παραβίαση της εφαρμογής ή/και του reverse engineering του κώδικα. Προτείνουμε να συμβουλευτείτε το έγγραφο του OWASP "Technical Risks of Reverse Engineering and Unauthorized Code Modification Reverse Engineering and Code Modification Prevention" (βλ. παραπομπές παρακάτω) για μια λίστα κινδύνων και σχετικών τεχνικών απειλών.

Για να είναι αποτελεσματικό οποιοδήποτε από τα στοιχεία ελέγχου της παρακάτω λίστας, η εφαρμογή πρέπει να πληροί τουλάχιστον όλα τα MASVS-L1 (δηλαδή, πρέπει να υπάρχουν σταθερά στοιχεία ελέγχου ασφαλείας), καθώς και όλες τις απαιτήσεις με χαμηλότερο αριθμό στο V8. Για παράδειγμα, τα obfuscation controls που παρατίθενται στην ενότητα "Παρεμπόδιση Κατανόησης (Impede Comprehension)" πρέπει να συνδυάζονται με την "Παρεμπόδιση δυναμικής ανάλυσης και παραβίασης (Ιmpede Dynamic Analysis and Tampering)" και "Δέσμευση με τη συσκευή (Device Binding)".

**Λάβετε υπόψη ότι οι προστασίες λογισμικού δεν πρέπει ποτέ να χρησιμοποιούνται ως αντικατάσταση των στοιχείων ελέγχου ασφαλείας. Τα στοιχεία ελέγχου που αναφέρονται στο MASVR-R προορίζονται να προσθέσουν ειδικά για την απειλή, πρόσθετα προστατευτικά στοιχεία ελέγχου σε εφαρμογές που πληρούν επίσης τις απαιτήσεις ασφαλείας MASVS.**

Ισχύουν οι ακόλουθες εκτιμήσεις:

1. Πρέπει να οριστεί ένα μοντέλο απειλών που να περιγράφει με σαφήνεια τις απειλές από την πλευρά του client που πρόκειται να προστατευθούν. Επιπλέον, πρέπει να προσδιορίζεται ο βαθμός προστασίας που προορίζεται να παρέχει το σύστημα. Για παράδειγμα, ένας δηλωμένος στόχος θα μπορούσε να είναι να αναγκαστούν οι δημιουργοί στοχευμένου malware που επιδιώκουν να βλάψουν την εφαρμογή να επενδύσουν σημαντική προσπάθεια manual reverse engineering.

2. Το μοντέλο απειλής πρέπει να είναι αξιόπιστο και σχετικό. Για παράδειγμα, η απόκρυψη ενός κρυπτογραφικού κλειδιού σε μια ανοιχτού κώδικα (white box) υλοποίησης μπορεί να αποδειχθεί περιττή, εάν ένας επιτιθέμενος μπορεί απλώς να υποκλέψει απευθείας το κώδικα.

3. Η αποτελεσματικότητα της προστασίας θα πρέπει πάντα να επαληθεύεται από έναν άνθρωπο, ειδικό με πείρα στη δοκιμή των συγκεκριμένων τύπων anti-tampering και obfuscation που χρησιμοποιούνται (βλ. επίσης τα κεφάλαια "reverse engineering" και "assessing software protections" στο OWASP Mobile Security Testing Guide)

<!-- \pagebreak -->

### Παρεμπόδιση δυναμικής ανάλυσης και παραβίασης (Impede Dynamic Analysis and Tampering)

| # | MSTG-ID | Description | R |
| -- | ----------- | ---------------------- | - |
| **8.1** | MSTG-RESILIENCE-1 | Η εφαρμογή εντοπίζει και ανταποκρίνεται στη παρουσία μιας rooted/jailbroken συσκευής είτε προειδοποιώντας το χρήστη είτε τερματίζοντας την εφαρμογή. | x |
| **8.2** | MSTG-RESILIENCE-2 | Η εφαρμογή εντοπίζει και ανταποκρίνεται σε ένα debugger που είναι σε χρήση. Όλα τα διαθέσιμα πρωτόκολλα debugging πρέπει να καλύπτονται. | x |
| **8.3** | MSTG-RESILIENCE-3 | Η εφαρμογή εντοπίζει και ανταποκρίνεται στη παραβίαση και τροποποίηση εκτελέσιμων αρχείων ή σημαντικών δεδομένων μέσα στο sandbox της. | x |
| **8.4** | MSTG-RESILIENCE-4 | Η εφαρμογή εντοπίζει και ανταποκρίνεται στη παρουσία ευρέως χρησιμοποιούμενων εργαλείων και frameworks στη συσκευή. | x |
| **8.5** | MSTG-RESILIENCE-5 | Η εφαρμογή εντοπίζει και ανταποκρίνεται στη λειτουργία μέσα σε emulator. | x |
| **8.6** | MSTG-RESILIENCE-6 | Η εφαρμογή εντοπίζει και ανταποκρίνεται στη παραβίαση και τροποποίηση του κώδικα και των δεδομένων μέσα στο memory space της. | x |
| **8.7** | MSTG-RESILIENCE-7 | Η εφαρμογή εφαρμόζει πολλαπλούς μηχανισμούς σε κάθε κατηγορία άμυνας (8.1 έως 8.6). Σημειώστε ότι η ανθεκτικότητα κλιμακώνεται με την ποσότητα και την ποικιλομορφία της πρωτοτυπίας των μηχανισμών που χρησιμοποιούνται. | x |
| **8.8** | MSTG-RESILIENCE-8 | Οι μηχανισμοί ανίχνευσης ενεργοποιούν αποκρίσεις διαφορετικών τύπων, συμπεριλαμβανομένων καθυστερημένων και κρυφών αποκρίσεων. | x |
| **8.9** | MSTG-RESILIENCE-9 | Το obfuscation εφαρμόζεται σε προγραμματικές άμυνες, οι οποίες με τη σειρά τους εμποδίζουν τo deobfuscation μέσω δυναμικής ανάλυσης.  | x |

<!-- \pagebreak -->
### Δέσμευση με τη συσκευή (Device Binding)

| # | MSTG-ID | Description | R |
| -- | ----------- | ---------------------- | - |
| **8.10** | MSTG-RESILIENCE-10 | Η εφαρμογή υλοποιεί μια λειτουργία «σύνδεσης συσκευής» (device binding) χρησιμοποιώντας ένα δακτυλικό αποτύπωμα συσκευής που προέρχεται από πολλαπλές ιδιότητες μοναδικές για τη συσκευή. | x |

### Παρεμπόδιση Κατανόησης (Impede Comprehension)

| # | MSTG-ID | Description | R |
| -- | ----------- | ---------------------- | - |
| **8.11** | MSTG-RESILIENCE-11 | Όλα τα εκτελέσιμα αρχεία και οι βιβλιοθήκες που ανήκουν στην εφαρμογή είτε είναι κρυπτογραφημένα σε επίπεδο αρχείου ή/και σημαντικά τμήματα κώδικα και δεδομένων μέσα στα εκτελέσιμα είναι κρυπτογραφημένα ή packed. Μια βασική στατική ανάλυση δεν αποκαλύπτει σημαντικό κώδικα ή δεδομένα.| x |
| **8.12** | MSTG-RESILIENCE-12 | Εάν ο στόχος του obfuscation είναι η προστασία ευαίσθητων υπολογισμών, χρησιμοποιείται ένα obfuscation scheme που είναι κατάλληλο για τη συγκεκριμένη εργασία και ανθεκτικό έναντι των χειροκίνητων (manual) και αυτοματοποιημένων μεθόδων deobfuscation, λαμβάνοντας υπόψη την τρέχουσα δημοσιευμένη έρευνα. Η αποτελεσματικότητα του συστήματος deobfuscation πρέπει να επαληθευτεί μέσω manual tests. Σημειώστε ότι οι λειτουργίες απομόνωσης που βασίζονται στο hardware προτιμώνται έναντι του obfuscation όποτε είναι δυνατόν. | x |

### Παρεμπόδιση Καταγραφής (Impede Eavesdropping)

| # | MSTG-ID | Description | R |
| -- | ----------- | ---------------------- | - |
| **8.13** | MSTG-RESILIENCE-13 | Ως άμυνα σε βάθος (defense-in-depth), εκτός από τo σταθερό hardening των μερών/υποσυστημάτων που επικοινωνούν, μπορεί να εφαρμοστεί κρυπτογράφηση payload σε επίπεδο εφαρμογής για να εμποδίσει περαιτέρω την υποκλοπή. | x |

<!-- \pagebreak -->

## Αναφορές

Tο OWASP Mobile Security Testing Guide παρέχει λεπτομερείς οδηγίες για την επαλήθευση των απαιτήσεων που αναφέρονται σε αυτήν την ενότητα.

- Android: Testing Resiliency Against Reverse Engineering - <https://github.com/OWASP/owasp-mstg/blob/master/Document/0x05j-Testing-Resiliency-Against-Reverse-Engineering.md>
- iOS: Testing Resiliency Against Reverse Engineering - <https://github.com/OWASP/owasp-mstg/blob/master/Document/0x06j-Testing-Resiliency-Against-Reverse-Engineering.md>

Για περισσότερες πληροφορίες, δείτε επίσης:

- OWASP Mobile Top 10: M8 (Code Tampering) - <https://owasp.org/www-project-mobile-top-10/2016-risks/m8-code-tampering>
- OWASP Mobile Top 10: M9 (Reverse Engineering) - <https://owasp.org/www-project-mobile-top-10/2016-risks/m9-reverse-engineering>
- OWASP Reverse Engineering Threats - <https://wiki.owasp.org/index.php/Technical_Risks_of_Reverse_Engineering_and_Unauthorized_Code_Modification>
- OWASP Reverse Engineering and Code Modification Prevention - <https://wiki.owasp.org/index.php/OWASP_Reverse_Engineering_and_Code_Modification_Prevention_Project>
