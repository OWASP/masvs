# Το Mobile Application Security Verification Standard

Το MASVS μπορεί να χρησιμοποιηθεί για να δημιουργήσει ένα επίπεδο εμπιστοσύνης στην ασφάλεια των mobile εφαρμογών. Οι απαιτήσεις αναπτύχθηκαν έχοντας κατά νου τους ακόλουθους στόχους:

- Χρήση ως metric - Για την παροχή ενός προτύπου ασφαλείας με το οποίο οι υπάρχουσες mobile εφαρμογές μπορούν να συγκριθούν από προγραμματιστές και κατόχους εφαρμογών.
- Χρήση ως καθοδήγηση - Για παροχή καθοδήγησης σε όλες τις φάσεις ανάπτυξης και δοκιμής εφαρμογών για κινητά.
- Χρήση κατά την προμήθεια - Παροχή βασικής γραμμής για επαλήθευση ασφάλειας mobile εφαρμογών.

## Μοντέλο Ασφάλειας Mobile Εφαρμογών

Το MASVS ορίζει δύο επίπεδα επαλήθευσης ασφαλείας (MASVS-L1 και MASVS-L2), καθώς και ένα σύνολο απαιτήσεων ανθεκτικότητας απέναντι σε reverse engineering (MASVS-R). Το MASVS-L1 περιέχει γενικές απαιτήσεις ασφαλείας που συνιστώνται για όλες τις mobile εφαρμογές, ενώ το MASVS-L2 θα πρέπει να εφαρμόζεται σε εφαρμογές που χειρίζονται εξαιρετικά ευαίσθητα δεδομένα. Το MASVS-R καλύπτει πρόσθετους προστατευτικούς ελέγχους που μπορούν να εφαρμοστούν εάν η αποτροπή απειλών από την πλευρά του client αποτελεί στόχο κατα το Design.

Η εκπλήρωση των απαιτήσεων στο MASVS-L1 οδηγεί σε μια ασφαλή εφαρμογή που ακολουθεί τις βέλτιστες πρακτικές ασφαλείας και δεν αντιμετωπίζει πρόβλημα από κοινά τρωτά σημεία. Το MASVS-L2 προσθέτει πρόσθετους ελέγχους με βάθος άμυνας, όπως το SSL pinning, με αποτέλεσμα μια εφαρμογή που είναι ανθεκτική σε πιο εξελιγμένες επιθέσεις - με την προϋπόθεση ότι οι μηχανισμοί ασφαλείας του λειτουργικού συστήματος του κινητού είναι άθικτοι και ο τελικός χρήστης δεν θεωρείται κακόβουλος. Η εκπλήρωση όλων ή υποσυνόλων των απαιτήσεων προστασίας λογισμικού στο MASVS-R συμβάλλει στην παρεμπόδιση συγκεκριμένων απειλών από την πλευρά του client όπου ο τελικός χρήστης είναι κακόβουλος ή/και το λειτουργικό σύστημα του κινητού είναι σε κίνδυνο.

**I: Αν και συνιστούμε την υλοποίηση των μηχανισμών του MASVS-L1 σε κάθε εφαρμογή, η υλοποίηση ενός μηχανισμού ή όχι θα πρέπει τελικά να είναι μια απόφαση βασισμένη στον ρίσκο, η οποία κοινοποιείται στους business owners και λαμβάνεται αντίστοιχα.**

**II: Να σημειωθεί ότι οι μηχανισμοί ελέγχου προστασίας λογισμικού που αναφέρονται στο MASVS-R και περιγράφονται στο OWASP Mobile Security Testing Guide μπορούν τελικά να παρακαμφθούν και δεν πρέπει ποτέ να χρησιμοποιηθούν ως αντικατάσταση των μηχανισμών ελέγχου ασφαλείας. Αντίθετα, προορίζονται να προσθέσουν έξτρα μηχανισμούς προστασίας βασισμένους σε απειλές, σε εφαρμογές που πληρούν επίσης τις απαιτήσεις MASVS στο MASVS-L1 ή στο MASVS-L2.**

![Verification Levels](images/masvs-levels-new.jpg)

### Δομή Εγγράφου

Το πρώτο μέρος του MASVS περιέχει μια περιγραφή του μοντέλου ασφαλείας και των διαθέσιμων επιπέδων επαλήθευσης, ακολουθούμενα από συστάσεις σχετικά με τον τρόπο χρήσης του προτύπου στην πράξη. Οι λεπτομερείς απαιτήσεις ασφαλείας, μαζί με μια αντιστοίχιση στα επίπεδα επαλήθευσης, παρατίθενται στο δεύτερο μέρος. Οι απαιτήσεις έχουν ομαδοποιηθεί σε οκτώ κατηγορίες (V1 έως V8) με βάση τον τεχνικό στόχο / πεδίο εφαρμογής. Η ακόλουθη ονοματολογία χρησιμοποιείται σε όλο το MASVS και το MSTG:

- *Κατηγορία Απαίτησης:* MASVS-Vx, e.g. MASVS-V2: Αποθήκευση Δεδομένων and Ιδιωτικότητα
- *Απαίτηση:* MASVS-Vx.y, e.g. MASVS-V2.2: "Στα αρχεία καταγραφής (logs) της εφαρμογής, δεν καταγράφονται ευαίσθητα δεδομένα."  

### Επίπεδα Επαλήθευσης σε Λεπτομέρεια

#### MASVS-L1: Τυπική Ασφάλεια

Μια mobile εφαρμογή που επιτυγχάνει το MASVS-L1 συμμορφώνεται με τις βέλτιστες πρακτικές ασφάλειας mobile εφαρμογών. Πληροί βασικές απαιτήσεις όσον αφορά την ποιότητα του κώδικα, το χειρισμό ευαίσθητων δεδομένων και την αλληλεπίδραση με το περιβάλλον κινητής τηλεφωνίας. Πρέπει να υπάρχει μια διαδικασία δοκιμής για την επαλήθευση των ελέγχων ασφαλείας. Αυτό το επίπεδο είναι κατάλληλο για όλες τις εφαρμογές για κινητές συσκευές.

#### MASVS-L2: Άμυνα σε Βάθος

Το MASVS-L2 εισάγει προηγμένους ελέγχους ασφαλείας που υπερβαίνουν τις τυπικές απαιτήσεις. Για να εκπληρωθεί το MASVS-L2, πρέπει να υπάρχει ένα μοντέλο απειλής (threat model) και η ασφάλεια πρέπει να αποτελεί αναπόσπαστο μέρος της αρχιτεκτονικής και του σχεδιασμού της εφαρμογής. Με βάση το μοντέλο απειλής, τα σωστά στοιχεία ελέγχου MASVS-L2 θα έπρεπε να έχουν επιλεγεί και υλοποιηθεί με επιτυχία. Αυτό το επίπεδο είναι κατάλληλο για εφαρμογές που χειρίζονται εξαιρετικά ευαίσθητα δεδομένα, όπως εφαρμογές mobile banking.

#### MASVS-R: Ανθεκτικότητα απέναντι σε Reverse Engineering και Παραποίηση (Tampering)

Η εφαρμογή διαθέτει ασφάλεια αιχμής και είναι επίσης ανθεκτική σε συγκεκριμένες, σαφώς καθορισμένες επιθέσεις από την πλευρά του client, όπως παραποίηση, τροποποίηση ή reverse engineering για την εξαγωγή ευαίσθητου κώδικα ή δεδομένων. Μια τέτοια εφαρμογή είτε αξιοποιεί hardware χαρακτηριστικά ασφαλείας, είτε επαρκώς ισχυρές και επαληθεύσιμες τεχνικές προστασίας λογισμικού. Το MASVS-R εφαρμόζεται σε εφαρμογές που χειρίζονται εξαιρετικά ευαίσθητα δεδομένα και μπορεί να χρησιμεύσει ως μέσο προστασίας της πνευματικής ιδιοκτησίας ή προστασίας από παραβιάσεις.

### Προτεινόμενη Χρήση

Οι εφαρμογές μπορούν να επαληθευτούν έναντι του MASVS L1 ή L2 με βάση την προηγούμενη αξιολόγηση κινδύνου και το συνολικό επίπεδο ασφάλειας που απαιτείται. Το L1 ισχύει για όλες τις mobile εφαρμογές, ενώ το L2 συνιστάται γενικά για εφαρμογές που χειρίζονται πιο ευαίσθητα δεδομένα ή/και λειτουργίες. Το MASVS-R (ή μέρη του) μπορεί να εφαρμοστεί για την επαλήθευση της ανθεκτικότητας έναντι συγκεκριμένων απειλών, όπως το repackaging ή η εξαγωγή ευαίσθητων δεδομένων, *επιπλέον* της κατάλληλης επαλήθευση ασφαλείας.

Συνοπτικά, είναι διαθέσιμοι οι ακόλουθοι τύποι επαλήθευσης:

- MASVS-L1
- MASVS-L1+R
- MASVS-L2
- MASVS-L2+R

Οι διαφορετικοί συνδυασμοί αντικατοπτρίζουν διαφορετικούς βαθμούς ασφάλειας και ανθεκτικότητας. Ο στόχος είναι να επιτραπεί η ευελιξία: Για παράδειγμα, ένα παιχνίδι για κινητά μπορεί να μην δικαιολογεί την προσθήκη στοιχείων ελέγχου ασφαλείας MASVS-L2, όπως ο έλεγχος ταυτότητας 2 παραγόντων (2-FA) για λόγους χρηστικότητας, αλλά έχει έντονη επιχειρησιακή ανάγκη για πρόληψη παραποιήσης.

#### Ποιο τύπο επαλήθευσης να επιλέξω

Η εφαρμογή των απαιτήσεων του MASVS L2 αυξάνει την ασφάλεια, ενώ ταυτόχρονα αυξάνει το κόστος ανάπτυξης και δυνητικά επιδεινώνει την εμπειρία του τελικού χρήστη (σύνηθες trade-off). Γενικά, το L2 θα πρέπει να χρησιμοποιείται για εφαρμογές όποτε έχει νόημα από την άποψη του κινδύνου έναντι του κόστους (δηλαδή, όταν η πιθανή απώλεια που προκαλείται από παραβίαση εμπιστευτικότητας ή ακεραιότητας είναι υψηλότερη από το κόστος που προκύπτει από τους πρόσθετους μηχανισμούς ασφαλείας). Η αποτίμηση κινδύνου (risk assessment) θα πρέπει να είναι το πρώτο βήμα πριν από την εφαρμογή του MASVS.

##### Παραδείγματα

###### MASVS-L1

- Όλες οι εφαρμογές για κινητά. Το MASVS-L1 παραθέτει τις βέλτιστες πρακτικές ασφαλείας που μπορούν να ακολουθηθούν με εύλογο αντίκτυπο στο κόστος ανάπτυξης και στην εμπειρία χρήστη. Εφαρμόστε τις απαιτήσεις στο MASVS-L1 για οποιαδήποτε εφαρμογή που δεν πληροί τις προϋποθέσεις για ένα από τα υψηλότερα επίπεδα.

###### MASVS-L2

- Κλάδος Υγειονομικής/Ιατρικής Περίθαλψης: Εφαρμογές για κινητά που αποθηκεύουν προσωπικά αναγνωρίσιμες πληροφορίες (PII) που μπορούν να χρησιμοποιηθούν για κλοπή ταυτότητας, πλαστές πληρωμές ή μια ποικιλία σχεδίων απάτης. Για τον τομέα της Περίθαλψης των Η.Π.Α., τα ζητήματα συμμόρφωσης περιλαμβάνουν τον Νόμο περί Φορητότητας και Λογοδοσίας Ασφάλισης Υγείας (HIPAA) για το απόρρητο, την ασφάλεια, τους κανόνες ειδοποίησης παραβίασης και τον κανόνα ασφάλειας ασθενών.
- Χρηματοοικονομικός Κλάδος: Εφαρμογές που επιτρέπουν την πρόσβαση σε εξαιρετικά ευαίσθητες πληροφορίες, όπως αριθμούς πιστωτικών καρτών, προσωπικά στοιχεία ή επιτρέπουν στον χρήστη να μετακινεί χρήματα. Αυτές οι εφαρμογές εγγυώνται πρόσθετους ελέγχους ασφαλείας για την αποφυγή απάτης. Οι οικονομικές εφαρμογές πρέπει να διασφαλίζουν τη συμμόρφωση με το Πρότυπο Ασφάλειας Δεδομένων του Κλάδου Πληρωμής (PCI DSS), το νόμο Gramm Leech Bliley και τον νόμο Sarbanes-Oxley (SOX).

###### MASVS L1+R

- Εφαρμογές για κινητά όπου η προστασία πνευματικής ιδιοκτησίας (IP) αποτελεί επιχειρηματικό στόχο. Τα στοιχεία ελέγχου ελαστικότητας που αναφέρονται στο MASVS-R μπορούν να χρησιμοποιηθούν για να αυξηθεί η προσπάθεια που απαιτείται για την απόκτηση του αρχικού πηγαίο κώδικα και να παρεμποδιστεί η παραβίαση/σπάσιμο.

- Κλάδος Οnline Παιχνιδιών: Παιχνίδια με ουσιαστική ανάγκη να αποφευχθεί η τροποποίηση και η εξαπάτηση, όπως τα ανταγωνιστικά διαδικτυακά παιχνίδια. Η εξαπάτηση είναι ένα σημαντικό ζήτημα στα διαδικτυακά παιχνίδια, καθώς ένας μεγάλος αριθμός απατεώνων οδηγεί σε μια δυσαρεστημένη βάση παικτών και μπορεί τελικά να προκαλέσει την αποτυχία ενός παιχνιδιού. Το MASVS-R παρέχει βασικούς ελέγχους κατά της παραβίασης που βοηθούν στην αύξηση της προσπάθειας για τους απατεώνες.

###### MASVS L2+R

- Χρηματοοικονομικός Κλάδος: Εφαρμογές ηλεκτρονικής τραπεζικής που επιτρέπουν στον χρήστη να μετακινεί κεφάλαια, όπου τεχνικές όπως το code injection και instrumentation ενέχουν κίνδυνο. Σε αυτήν την περίπτωση, οι μηχανισμοί ελέγχου από το MASVS-R μπορούν να χρησιμοποιηθούν για να εμποδίσουν την παραβίαση, ανεβάζοντας τον πήχη για τους δημιουργούς κακόβουλου λογισμικού.

- Όλες οι εφαρμογές για κινητά οι οποίες εκ κατασκευής, πρέπει να αποθηκεύουν ευαίσθητα δεδομένα στη φορητή συσκευή και ταυτόχρονα πρέπει να υποστηρίζουν ένα ευρύ φάσμα συσκευών και εκδόσεων λειτουργικού συστήματος. Σε αυτήν την περίπτωση, οι έλεγχοι ανθεκτικότητας μπορούν να χρησιμοποιηθούν ως μέτρο Άμυνας σε Βάθος (Defence in depth) για να αυξήσουν την προσπάθεια των επιτιθέμενων που στοχεύουν στην εξαγωγή των ευαίσθητων δεδομένων.

- Οι εφαρμογές που υποστηρίζουν αγορές εντός εφαρμογής θα πρέπει ιδανικά να χρησιμοποιούν μηχανισμούς ελέγχου από την πλευρά του server και MASVS-L2 για την προστασία του επί πληρωμή περιεχομένου (paid content). Ωστόσο, ενδέχεται να υπάρχουν περιπτώσεις όπου δεν υπάρχει δυνατότητα χρήσης προστασίας από την πλευρά του server. Σε αυτές τις περιπτώσεις, οι μηχανισμοί MASVS-R θα πρέπει να εφαρμόζονται σαν έξτρα, προκειμένου να αυξηθεί η απαιτούμενα προσπάθεια του επιτιθέμενου για reversing ή tampering.
