# The Mobile Application Security Verification Standard

MASVS может быть использован для подтверждения определенного уровня уверенности в безопасности мобильных приложений. Требования были сформированы для достижения следующих целей:


* Использование в качестве показателя: для предоставления стандарта безопасности, с которым разработчики и владельцы уже существующих мобильных приложений могут сравнивать свои продукты.
* Использование в качестве руководства: для предоставления рекомендаций во время всех этапов разработки и тестирования.
* Использование во время закупок: как основание для проверки безопасности мобильного приложения.

## Модель безопасности мобильных приложений

MASVS определяет 2 строгих уровня проверки безопасности (L1 и L2), а также набор гибких требований для обеспечения защиты, затрудняющую обратную разработку/реверс инжиниринг(reverse engineering) (MASVS-R), то есть адаптируются к конкретной модели угроз приложения. MASVS-L1 и MASVS-L2 содержат общие требования к безопасности и рекомендуются для всех мобильных приложений (L1) и для приложений, которые обрабатывают очень чувствительные данные(L2). MASVS-R охватывает дополнительные меры защиты, которые могут применяться в случае, если предотвращение атак на стороне клиента является заложенным свойством архитектуры. 

Выполнение требований MASVS-L1 приводит к созданию безопасного приложения, которое следует всем лучшим практикам безопасности и не подверженно часто встречающимся уязвимостям. MASVS-L2 добавляет эшелонированность защиты, например SSL pinning, приводящую к отказоустойчивости приложения при более ухущренных атаках, при условии, что безопасность мобильной операционной системы не скомпрометирована, а конечный пользователь не рассматривается как потенциальный злоумышленник. Выполнение всех или подмножества требований защиты программного обеспечения в MASVS-R помогает препятствовать конкретным угрозам на стороне клиента, когда конечный пользователь является злоумышленником и/или мобильная ОС скомпрометирована.

**Обратите внимание, что меры защиты программного обеспечения, перечисленные в MASVS-R и OWASP Mobile Testing Guide, можно обойти и они никогда не должны использоваться в качестве замены управления безопасности мобильного приложения. Вместо этого они должны использоваться как специализированное дополнение, направленное на локализацию конкретных угроз, в мобильном приложение, которое
удовлетворяет требования MASVS L1 или L2.**

![Verification Levels](images/masvs-levels-new.jpg)

### Структура документа

Первая часть MASVS содержит описание модели безопасности и доступных уровней проверок, а затем рекомендации о том, как использовать стандарт на практике. Подробные требования безопасности, а также сопоставление их с уровнем верификации, перечислены во второй части. Требования были сгруппированы в восемь категорий (от V1 по V8) по принадлежности к технической цели/области. Следующая номенклатура используется на протяжении всего MASVS и MSTG:

- *Категория требований:* MASVS-Vx, например, MASVS-V2: хранение и конфиденциальность данных
- *Требование:* MASVS-Vx.y, например, MASVS-V2.2: «В журналы приложений не записываются конфиденциальные данные».

### Подробное описание уровней верификации

#### MASVS-L1: Стандартная безопасность

Мобильное приложение, которое удовлетворяет MASVS-L1, придерживается лучших практик обеспечения безопасности мобильных приложений. Данный уровень верификации предоставляет основные требования с точки зрения качества кода, обработки конфиденциальных данных и взаимодействия с мобильной средой. Для подтверждения соответствия приложения данному уровню безопасности должен быть развернут процесс тестирования. Этот уровень подходит для всех мобильных приложений.

#### MASVS-L2: Глубокая эшелонированность защиты
<!---Официальный перевод 4 редакции Таненбаума "Операционные системы", термина defense in-depth --->
MASVS-L2 предлагает расширенные средства верификации безопасности, выходящие за рамки стандартных. Чтобы соответствовать L2, должна существовать модель угроз, и безопасность должна быть неотъемлемой частью архитектуры и дизайна приложения. Этот уровень подходит для приложений, которые обрабатывают чувствительные данные, такие как мобильный банкинг.

#### MASVS-R: Устойчивость к обратному проектированию и фальсификации(tampering)

Приложение имеет самую современную безопасность и также устойчиво к конкретным, четко определенным атакам на стороне клиента, таким как подмена/фальсификация(tampering), модификация или обратное проектирование для извлечения чувствительного кода или данных. Такое приложение либо использует аппаратные средства безопасности, либо достаточно надёжные и проверяемые методы программной защиты. MASVS-R применим к приложениям, которые обрабатывают высокочувствительные данные и могут служить средством защиты интеллектуальной собственности или защиты от несанкционированного доступа.

### Рекомендованное использование

Приложения могут быть проверены на соответствие MASVS L1 или L2, основываясь на предварительной оценке рисков и общего понимания требуемого уровня безопасности. L1 применим ко всем мобильным приложениям, в то время как L2 обычно рекомендуется для приложений, которые обрабатывают более чувствительные данные и/или реализуют чувствительную функциональность. MASVS-R (или его части) может быть применен для верификации отказоустойчивости от конкретных угроз, таких как переупаковка или извлечение конфиденциальных данных, *или же*, для осуществления надежной проверки безопасности.

Таким образом, доступны следующие типы верификации:

- MASVS-L1
- MASVS-L1 + R
- MASVS-L2
- MASVS-L2 + R

Различные комбинации отражают различные уровни безопасности и отказоустойчивости. Цель состоит в том, чтобы обеспечить гибкость: например, мобильная игра может не гарантировать добавление средств безопасности MASVS-L2, таких как двухфакторная аутентификация по причинам удобства использования, но обладает потребностью бизнеса в предотвращении фальсификации.

#### Какой тип верификации выбрать

Соответсвие требованиям MASVS L2 повышает безопасность и в то же время увеличивает стоимость разработки и потенциально делает хуже опыт конечного пользователя (классический компромисс). В общем случае, L2 следует использовать для приложений, когда это имеет смысл с точки зрения риска и стоимости (т. е. когда потенциальная потеря, вызванная компромиссной реализацией конфиденциальности или целостности, выше, чем затраты, связанные с дополнительными проверками безопасности). Оценка риска должна быть первым шагом перед применением MASVS.

##### Примеры

###### MASVS-L1

- Все мобильные приложения. В MASVS-L1 перечислены рекомендации по безопасности, которые могут быть выполнены с разумным воздействием на стоимость разработки и пользовательский опыт. Применяйте требования MASVS-L1 для любого приложения, которое не подходит ни под один из более высоких уровней.

###### MASVS-L2


- Индустрия здравоохранения: мобильные приложения, которые хранят личную информацию, которая может использоваться для кражи личных данных, мошеннических платежей или различных схем мошенничества. Для сектора здравоохранения США пункты проверок включают в себя закон о переносимости и подотчетности медицинского страхования (HIPAA), привила безопасности, правила уведомления о нарушениях и правило безопасности пациентов.

- Финансовая индустрия: приложения, которые обеспечивают доступ к высокочувствительной информации, такой как номера кредитных карт, личной информации или позволяют переводить средства. Эти приложения требуют дополнительных средств контроля безопасности для предотвращения мошенничества. Финансовым приложениям необходимо обеспечить соблюдение стандартов безопасности данных, изложенных в Payment Card Industry Data Security Standard (PCI DSS), акт Gramm Leech Bliley и акт Sarbanes-Oxley (SOX).

###### MASVS L1+R


- Мобильные приложения, где защита IP - это основа бизнеса. Проверки отказоустойчивости, перечисленные в MASVS-R, могут использоваться для увеличения усилий, необходимых для получения исходного кода, и для предотвращения фальсификации или взлома.

- Игровая индустрия: игры с существенной необходимостью предотвращения возможности изменять игру и использовать читы, например, конкурирующие онлайн игры. Читинг является важной проблемой в онлайн-играх, так как большое количество мошенников делают игроков недовольными и в конечном итоге может привести к краху конкретного игрового продукты. MASVS-R предоставляет основные средства проверки защиты, направленные на предотвращение несанкционированного доступа, которые увеличивают усилия, которые необходимо приложить читерам.

###### MASVS L2+R


- Финансовая индустрия: приложения для онлайн банкинга, которые позволяют пользователю переводить средства, где инъекция кода и инструментирование на взломанных(jailbreak/root) устройствах представляют собой риск. В этом случае, верификация MASVS-R может быть использована, чтобы препятствовать фальсификации, повышая сложность для авторов вредоносных программ.


- Все мобильные приложения, в архитектуре которых заложено хранение конфиденциальных данных на мобильном устройстве и в то же время заложена поддержка широкого спектра устройств и версий операционной системы. В этом случае проверка отказоустойчивости может использоваться в качестве меры эшелонированной защиты, чтобы извлечение конфиденциальных данных злоумышленником было затруднено максимально. 
