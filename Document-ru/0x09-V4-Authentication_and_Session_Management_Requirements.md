# V4: Требования к аутентификации и управлению сессиями

## Цель верификации

В большинстве случаев, процесс входа в удаленную службу, являются неотъемлемой частью общей архитектуры мобильного приложения. Несмотря на то, что большая часть логики происходит на эндпоинте, MASVS определяет некоторые основные требования, касающиеся управления учетными записями пользователей и сессиями.

## Требования к верификации безопасности

| # | Описание | L1 | L2 |
| --- | --- | --- | --- |
| **4.1** | Если приложение предоставляет пользователям доступ к удаленной службе, на удаленном эндпоинте выполняется некоторая форма аутентификации, например аутентификация имени пользователя и пароля. | ✓ | ✓ |
| **4.2** | Если используется управление сессиям с использованием состояния(Statefull), эндпоинт использует случайно генерируемые идентификаторы сессии для аутентификации клиентских запросов, чтобы не отправлять учетные данные пользователя.  | ✓ | ✓ |
| **4.3** | Если используется аутентификация без состояний (stateless), на основе токена, сервер предоставляет токен, который был подписан с использованием защищенного алгоритма. | ✓ | ✓ |
| **4.4** | Эндпоинт завершает существующую сессию, когда пользователь выходит из системы. | ✓ | ✓ |
| **4.5** | Политика паролей существует и применяется на удаленном веб- сервисе. | ✓ | ✓ |
| **4.6** | Эндпоинт реализует механизм для защиты от предоставления учетных данных чрезмерное количество раз. | ✓ | ✓ |
| **4.7** | Сессии становятся недействительны на эндпоинте после предопределенного периода бездействия, а также токен стоновится невалиден. | ✓ | ✓ |
| **4.8** | Биометрическая аутентификация, если она есть, не связана с событиями (т.е. с использованием API, который просто возвращает «истина» или «ложь»). Вместо этого она основана на разблокировке keychain/keystore. |   | ✓ |
| **4.9** | Второй фактор аутентификации существует на эндпоинте, и требование 2FA последовательно используется.  |   | ✓ |
| **4.10** | Для чувствительных транзакций требуется более высокий уровень аутентификации.  |   | ✓ |
| **4.11** | Приложение информирует пользователя о всех действиях входа в систему, с использованием своей учетной записи. Пользователи могут просматривать список устройств, используемых для доступа к учетной записи, и блокировать определенные устройства. |  | ✓ |

## Ссылки

OWASP MSTG содержит подробные инструкции по верификации требований, перечисленных в этом разделе.

- Для Android - https://github.com/OWASP/owasp-mstg/blob/master/Document/0x05f-Testing-Authentication.md
- Для iOS - https://github.com/OWASP/owasp-mstg/blob/master/Document/0x06f-Testing-Authentication-and-Session-Management.md

Для получения дополнительной информации смотрите также:

- OWASP Mobile Top 10: [M4 - Insecure Authentication](https://www.owasp.org/index.php/Mobile_Top_10_2016-M4-Insecure_Authentication), [M6 - Insecure Authorization](https://www.owasp.org/index.php/Mobile_Top_10_2016-M6-Insecure_Authorization)
- CWE:  https://cwe.mitre.org/data/definitions/287.html
